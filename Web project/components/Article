export default {
    name: 'ArticleList',

    template: `
        <main v-show="this.page == 'home'">
            
            <main class="container">
                <article class ="breaking-news" v-if="breakingNewsArticle">
                    <a href="#" @click.prevent="showArticleDetails(breakingNewsArticle)">
                        <img :src="'./media/' + breakingNewsArticle.image + '.jpg'" alt="Breaking News Image">
                        <nav class="text">
                            <h2><strong>{{ breakingNewsArticle.title }}</strong></h2>
                            <h3 v-html="breakingNewsArticle.resume"></h3>
                        </nav>
                    </a>
                </article>
                
                <aside class="sidebar" aria-label="Portraits">
                    <a href="#" 
                        v-for="article in portraitArticles" 
                        :key="article.id" 
                        @click.prevent="showArticleDetails(article)">
                        
                        <article class="sidebar-item">
                            <img :src="'./media/' + article.image + '.jpg'" alt="Sidebar Image">
                            <div class="text">
                                <span class="tag">{{ article.category }}</span>
                                <h4 v-html="article.resume"></h4>
                            </div>
                        </article>
                    </a>
                </aside>
                
                
                <section class="bottom-grid" aria-label="Culture">
                    <article class="card" v-for="article in culturelArticles" :key="article.id">
                        <a href="#" @click.prevent="showArticleDetails(article)">
                            <img :src="'./media/' + article.image + '.jpg'" alt="">
                            <span class="tag gray">{{ article.category }}</span>
                            <h4 v-html="article.resume"></h4>
                        </a>
                    </article>
                </section>
                
                
                <section class="bottom-mini" aria-label="Bibliographie">
                    <article class="card small" v-for="article in biblioArticles" :key="article.id">
                        <a href="#" @click.prevent="showArticleDetails(article)">
                            <img :src="'./media/' + article.image + '.jpg'" alt="">
                            <h4 v-html="article.resume"></h4>
                        </a>
                    </article>
                </section>
            </main>
        </main>
        `,
    props : {
        page    :{
            type        :String,
            required    :true,
        },
        searchQuery :{
            type        :String,
            default     :'',
        }
    },
    
    // --- PARTIE AJOUTÉE OU COMPLÉTÉE ---
    
    data() {
        return {
            selectedArticle : null,
            // ATTENTION : Vous devez définir ici la liste `articles` pour que les filtres fonctionnent
            articles: [
               ]
        }
    },

    computed : {
        filteredArticles() {
            if (!this.searchQuery) {
                return this.articles;
            }
            const query = this.searchQuery.toLowerCase();
            return this.articles.filter(
                article => article.title.toLowerCase().includes(query) || 
                           article.category.toLowerCase().includes(query) ||
                           article.author.toLowerCase().includes(query) // Assurez-vous d'avoir 'author'
            );
        },
        breakingNewsArticle() {
            return this.filteredArticles.find(article => article.type === 'breaking');
        },
        portraitArticles() {
            return this.filteredArticles.filter(article => article.type === 'portrait');
        },
        culturelArticles() {
            return this.filteredArticles.filter(article => article.type === 'culturel');
        },
        biblioArticles() {
            return this.filteredArticles.filter(article => article.type === 'biblio');
        }
    },

    methods: {
        /**
         * Méthode pour sélectionner un article et demander au composant parent d'afficher les détails.
         * @param {Object} article - L'objet article complet à afficher.
         */
        showArticleDetails(article) {
            console.log("Détails de l'article demandés : " + article.title);
        }
    }
}
